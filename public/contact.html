<!DOCTYPE html>
<html lang="zxx" class="no-js">

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<link rel="shortcut icon" href="img/fav.png">
	<meta name="author" content="codepixer">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta charset="UTF-8">
	<title>HK Gallery</title>

	<!-- Template CSS -->
	<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,400,300,500,600,700" rel="stylesheet">
	<link rel="stylesheet" href="css/linearicons.css">
	<link rel="stylesheet" href="css/font-awesome.min.css">
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/magnific-popup.css">
	<link rel="stylesheet" href="css/nice-select.css">
	<link rel="stylesheet" href="css/animate.min.css">
	<link rel="stylesheet" href="css/owl.carousel.css">
	<link rel="stylesheet" href="css/main.css">
</head>

<body>

	<!-- Header  -->
	<header id="header">
		<div class="container header-top">
			<div class="row">
				<div class="col-6 top-head-left">
					<ul>
						<li><a href="#">VisitÂ Us</a></li>
						<li><a href="#">BuyÂ Ticket</a></li>
					</ul>
				</div>
				<div class="col-6 top-head-right">
					<ul>
						<li><a href="#"><i class="fa fa-facebook"></i></a></li>
						<li><a href="#"><i class="fa fa-twitter"></i></a></li>
						<li><a href="#"><i class="fa fa-dribbble"></i></a></li>
						<li><a href="#"><i class="fa fa-behance"></i></a></li>
					</ul>
				</div>
			</div>
		</div>
		<hr>
		<div class="container">
			<div class="row align-items-center justify-content-between d-flex">
				<div id="logo"><a href="index.html"><img src="img/logo.png" alt="logo" /></a></div>
				<nav id="nav-menu-container">
					<ul class="nav-menu">
						<li class="menu-active"><a href="index.html">Home</a></li>
						<li><a href="about.html">About</a></li>
						<li><a href="collection.html">MyÂ Collection</a></li>
						<li><a href="contact.html">MyÂ Profile</a></li>
						<li><a href="#" id="viewCartBtn">ðŸ›’Â Cart <span id="cartCount"
									style="font-size:.8em;">0</span></a></li>
						<li><a href="/auth/logout">Logout</a></li>
					</ul>
				</nav>
			</div>
		</div>
	</header>
	<!-- Header  -->

	<!-- start banner Area -->
	<section class="banner-area relative" id="home">
		<div class="overlay overlay-bg"></div>
		<div class="container">
			<div class="row d-flex align-items-center justify-content-center">
				<div class="about-content col-lg-12">
					<h1 class="text-white">
						My Profile
					</h1>
					<p class="text-white link-nav"><a href="index.html">Home </a> <span
							class="lnr lnr-arrow-right"></span> <a href="contact.html"> My Profile </a></p>
				</div>
			</div>
		</div>
	</section>
	<!-- End banner Area -->

	<!-- Profile -->
	<div class="container mt-4" id="alerts"></div>
		<div class="d-flex justify-content-center mt-5">
			<form id="profileForm" class="p-4 border rounded bg-light" style="width:100%; max-width:600px;">
				<div class="form-group">
					<label for="username">Username</label>
					<input name="username" id="username" class="form-control" type="text" disabled />
				</div>
				<div class="form-group mt-3">
					<label for="email">Email</label>
					<input name="email" id="email" class="form-control" type="email" disabled required />
				</div>
				<div class="form-group mt-3">
					<label for="fullName">Full Name</label>
					<input name="fullName" id="fullName" class="form-control" type="text" disabled />
				</div>
				<div class="form-group mt-3">
					<label for="bio">Bio</label>
					<textarea name="bio" id="bio" rows="4" class="form-control" disabled></textarea>
				</div>
				<button class="btn btn-secondary mt-3 w-100" id="editBtn" type="button">Edit Profile</button>
				<button class="btn btn-primary mt-3 w-100" id="updateBtn" type="submit" style="display: none;">Update
					Profile</button>
			</form>
		</div>
	</div>
	<!-- Profile -->

	<!-- Footer-->
	<hr style="margin-top:80px">
	<footer class="footer-area section-gap">
		<div class="container">
			<div class="row">
				<div class="col-lg-5 col-md-6 col-sm-6">
					<div class="single-footer-widget">
						<h6>About HK Gallery</h6>
						<p>
							HK Gallery brings museum-quality artworks to your screen. Discover, collect and enjoy your
							favorite
							piecesâ€”all in one place.
						</p>
						<p class="footer-text">
							Â©
							<script>document.write(new Date().getFullYear())</script> HK Gallery. All rights reserved.
						</p>
					</div>
				</div>
				<div class="col-lg-5 col-md-6 col-sm-6">
					<div class="single-footer-widget">
						<h6>Newsletter</h6>
						<p>Join our mailing list for new arrivals, exclusive previews, and art insights.</p>
						<form class="form-inline">
							<input class="form-control" placeholder="Your email address" type="email" required>
							<button class="click-btn btn btn-default" type="submit">
								<span class="lnr lnr-arrow-right"></span>
							</button>
						</form>
					</div>
				</div>
				<div class="col-lg-2 col-md-6 col-sm-6 social-widget">
					<div class="single-footer-widget">
						<h6>Follow Us</h6>
						<div class="footer-social d-flex align-items-center">
							<a href="#"><i class="fa fa-facebook"></i></a>
							<a href="#"><i class="fa fa-twitter"></i></a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer>

	<!-- Scripts -->
	<script src="js/vendor/jquery-2.2.4.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
		integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		crossorigin="anonymous"></script>
	<script src="js/vendor/bootstrap.min.js"></script>
	<script type="text/javascript"
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhOdIF3Y9382fqJYt5I_sswSrEw5eihAA"></script>
	<script src="js/easing.min.js"></script>
	<script src="js/hoverIntent.js"></script>
	<script src="js/superfish.min.js"></script>
	<script src="js/jquery.ajaxchimp.min.js"></script>
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/owl.carousel.min.js"></script>
	<script src="js/imagesloaded.pkgd.min.js"></script>
	<script src="js/justified.min.js"></script>
	<script src="js/jquery.sticky.js"></script>
	<script src="js/jquery.nice-select.min.js"></script>
	<script src="js/parallax.min.js"></script>
	<script src="js/mail-script.js"></script>
	<script src="js/main.js"></script>
</body>

</html>

<script>
	// Loads user profile data when page loads
	fetch('/api/profile')
		.then(res => res.json())
		.then(user => {
			document.getElementById('username').value = user.username || '';
			document.getElementById('email').value = user.email || '';
			document.getElementById('fullName').value = user.fullName || '';
			document.getElementById('bio').value = user.bio || '';
		});

	// Controls edit and update buttons
	document.getElementById('editBtn').addEventListener('click', () => {
		// Enables the input fields
		['username', 'email', 'fullName', 'bio'].forEach(id => {
			document.getElementById(id).removeAttribute('disabled');
		});
		document.getElementById('editBtn').style.display = 'none';
		document.getElementById('updateBtn').style.display = 'block';
	});


	// Profile Update Alert 
	const qs = id => document.getElementById(id);
    function showAlert(message, type = 'success') {
      qs('alerts').innerHTML =
        `<div class="alert alert-${type} alert-dismissible fade show" role="alert">
           ${message}
         </div>`;
    }

	// Handles form submission 
	document.getElementById('profileForm').addEventListener('submit', async (e) => {
		e.preventDefault();

		const email = document.getElementById('email').value;
		const fullName = document.getElementById('fullName').value;
		const bio = document.getElementById('bio').value;

		const response = await fetch('/api/profile/update', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ email, fullName, bio })
		});

		if (response.ok) {
		showAlert('Profile updated successfully');

		// Disables fields when updates
		['username', 'email', 'fullName', 'bio'].forEach(id => {
			document.getElementById(id).setAttribute('disabled', true);
		});

		document.getElementById('editBtn').style.display = 'block';
		document.getElementById('updateBtn').style.display = 'none';
		} else {
		showAlert('Failed to update profile', 'danger');
		}
	});

</script>